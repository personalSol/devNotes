/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var fn=Object.create;var ue=Object.defineProperty;var un=Object.getOwnPropertyDescriptor;var dn=Object.getOwnPropertyNames;var hn=Object.getPrototypeOf,gn=Object.prototype.hasOwnProperty;var pn=(f,i)=>()=>(i||f((i={exports:{}}).exports,i),i.exports),mn=(f,i)=>{for(var s in i)ue(f,s,{get:i[s],enumerable:!0})},qe=(f,i,s,l)=>{if(i&&typeof i=="object"||typeof i=="function")for(let u of dn(i))!gn.call(f,u)&&u!==s&&ue(f,u,{get:()=>i[u],enumerable:!(l=un(i,u))||l.enumerable});return f};var Ze=(f,i,s)=>(s=f!=null?fn(hn(f)):{},qe(i||!f||!f.__esModule?ue(s,"default",{value:f,enumerable:!0}):s,f)),vn=f=>qe(ue({},"__esModule",{value:!0}),f);var Re=pn((et,Se)=>{(function(f){if(typeof et=="object"&&typeof Se!="undefined")Se.exports=f();else if(typeof define=="function"&&define.amd)define([],f);else{var i;typeof window!="undefined"?i=window:typeof global!="undefined"?i=global:typeof self!="undefined"?i=self:i=this,i.localforage=f()}})(function(){var f,i,s;return function l(u,C,y){function E(x,I){if(!C[x]){if(!u[x]){var h=typeof require=="function"&&require;if(!I&&h)return h(x,!0);if(v)return v(x,!0);var T=new Error("Cannot find module '"+x+"'");throw T.code="MODULE_NOT_FOUND",T}var S=C[x]={exports:{}};u[x][0].call(S.exports,function(R){var D=u[x][1][R];return E(D||R)},S,S.exports,l,u,C,y)}return C[x].exports}for(var v=typeof require=="function"&&require,g=0;g<y.length;g++)E(y[g]);return E}({1:[function(l,u,C){(function(y){"use strict";var E=y.MutationObserver||y.WebKitMutationObserver,v;if(E){var g=0,x=new E(R),I=y.document.createTextNode("");x.observe(I,{characterData:!0}),v=function(){I.data=g=++g%2}}else if(!y.setImmediate&&typeof y.MessageChannel!="undefined"){var h=new y.MessageChannel;h.port1.onmessage=R,v=function(){h.port2.postMessage(0)}}else"document"in y&&"onreadystatechange"in y.document.createElement("script")?v=function(){var L=y.document.createElement("script");L.onreadystatechange=function(){R(),L.onreadystatechange=null,L.parentNode.removeChild(L),L=null},y.document.documentElement.appendChild(L)}:v=function(){setTimeout(R,0)};var T,S=[];function R(){T=!0;for(var L,U,M=S.length;M;){for(U=S,S=[],L=-1;++L<M;)U[L]();M=S.length}T=!1}u.exports=D;function D(L){S.push(L)===1&&!T&&v()}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(l,u,C){"use strict";var y=l(1);function E(){}var v={},g=["REJECTED"],x=["FULFILLED"],I=["PENDING"];u.exports=h;function h(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=I,this.queue=[],this.outcome=void 0,w!==E&&D(this,w)}h.prototype.catch=function(w){return this.then(null,w)},h.prototype.then=function(w,F){if(typeof w!="function"&&this.state===x||typeof F!="function"&&this.state===g)return this;var A=new this.constructor(E);if(this.state!==I){var N=this.state===x?w:F;S(A,N,this.outcome)}else this.queue.push(new T(A,w,F));return A};function T(w,F,A){this.promise=w,typeof F=="function"&&(this.onFulfilled=F,this.callFulfilled=this.otherCallFulfilled),typeof A=="function"&&(this.onRejected=A,this.callRejected=this.otherCallRejected)}T.prototype.callFulfilled=function(w){v.resolve(this.promise,w)},T.prototype.otherCallFulfilled=function(w){S(this.promise,this.onFulfilled,w)},T.prototype.callRejected=function(w){v.reject(this.promise,w)},T.prototype.otherCallRejected=function(w){S(this.promise,this.onRejected,w)};function S(w,F,A){y(function(){var N;try{N=F(A)}catch(H){return v.reject(w,H)}N===w?v.reject(w,new TypeError("Cannot resolve promise with itself")):v.resolve(w,N)})}v.resolve=function(w,F){var A=L(R,F);if(A.status==="error")return v.reject(w,A.value);var N=A.value;if(N)D(w,N);else{w.state=x,w.outcome=F;for(var H=-1,$=w.queue.length;++H<$;)w.queue[H].callFulfilled(F)}return w},v.reject=function(w,F){w.state=g,w.outcome=F;for(var A=-1,N=w.queue.length;++A<N;)w.queue[A].callRejected(F);return w};function R(w){var F=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof F=="function")return function(){F.apply(w,arguments)}}function D(w,F){var A=!1;function N(V){A||(A=!0,v.reject(w,V))}function H(V){A||(A=!0,v.resolve(w,V))}function $(){F(H,N)}var G=L($);G.status==="error"&&N(G.value)}function L(w,F){var A={};try{A.value=w(F),A.status="success"}catch(N){A.status="error",A.value=N}return A}h.resolve=U;function U(w){return w instanceof this?w:v.resolve(new this(E),w)}h.reject=M;function M(w){var F=new this(E);return v.reject(F,w)}h.all=Z;function Z(w){var F=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=w.length,N=!1;if(!A)return this.resolve([]);for(var H=new Array(A),$=0,G=-1,V=new this(E);++G<A;)X(w[G],G);return V;function X(ne,ce){F.resolve(ne).then(me,function(ee){N||(N=!0,v.reject(V,ee))});function me(ee){H[ce]=ee,++$===A&&!N&&(N=!0,v.resolve(V,H))}}}h.race=Q;function Q(w){var F=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=w.length,N=!1;if(!A)return this.resolve([]);for(var H=-1,$=new this(E);++H<A;)G(w[H]);return $;function G(V){F.resolve(V).then(function(X){N||(N=!0,v.resolve($,X))},function(X){N||(N=!0,v.reject($,X))})}}},{1:1}],3:[function(l,u,C){(function(y){"use strict";typeof y.Promise!="function"&&(y.Promise=l(2))}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(l,u,C){"use strict";var y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function E(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function v(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(e){return}}var g=v();function x(){try{if(!g||!g.open)return!1;var e=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(t){return!1}}function I(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(r){if(r.name!=="TypeError")throw r;for(var t=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,o=new t,a=0;a<e.length;a+=1)o.append(e[a]);return o.getBlob(n.type)}}typeof Promise=="undefined"&&l(3);var h=Promise;function T(e,n){n&&e.then(function(t){n(null,t)},function(t){n(t)})}function S(e,n,t){typeof n=="function"&&e.then(n),typeof t=="function"&&e.catch(t)}function R(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function D(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var L="local-forage-detect-blob-support",U=void 0,M={},Z=Object.prototype.toString,Q="readonly",w="readwrite";function F(e){for(var n=e.length,t=new ArrayBuffer(n),o=new Uint8Array(t),a=0;a<n;a++)o[a]=e.charCodeAt(a);return t}function A(e){return new h(function(n){var t=e.transaction(L,w),o=I([""]);t.objectStore(L).put(o,"key"),t.onabort=function(a){a.preventDefault(),a.stopPropagation(),n(!1)},t.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);n(r||!a||parseInt(a[1],10)>=43)}}).catch(function(){return!1})}function N(e){return typeof U=="boolean"?h.resolve(U):A(e).then(function(n){return U=n,U})}function H(e){var n=M[e.name],t={};t.promise=new h(function(o,a){t.resolve=o,t.reject=a}),n.deferredOperations.push(t),n.dbReady?n.dbReady=n.dbReady.then(function(){return t.promise}):n.dbReady=t.promise}function $(e){var n=M[e.name],t=n.deferredOperations.pop();if(t)return t.resolve(),t.promise}function G(e,n){var t=M[e.name],o=t.deferredOperations.pop();if(o)return o.reject(n),o.promise}function V(e,n){return new h(function(t,o){if(M[e.name]=M[e.name]||Ne(),e.db)if(n)H(e),e.db.close();else return t(e.db);var a=[e.name];n&&a.push(e.version);var r=g.open.apply(g,a);n&&(r.onupgradeneeded=function(c){var d=r.result;try{d.createObjectStore(e.storeName),c.oldVersion<=1&&d.createObjectStore(L)}catch(p){if(p.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+c.oldVersion+" to version "+c.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw p}}),r.onerror=function(c){c.preventDefault(),o(r.error)},r.onsuccess=function(){var c=r.result;c.onversionchange=function(d){d.target.close()},t(c),$(e)}})}function X(e){return V(e,!1)}function ne(e){return V(e,!0)}function ce(e,n){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,a=e.version>e.db.version;if(o&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),a||t){if(t){var r=e.db.version+1;r>e.version&&(e.version=r)}return!0}return!1}function me(e){return new h(function(n,t){var o=new FileReader;o.onerror=t,o.onloadend=function(a){var r=btoa(a.target.result||"");n({__local_forage_encoded_blob:!0,data:r,type:e.type})},o.readAsBinaryString(e)})}function ee(e){var n=F(atob(e.data));return I([n],{type:e.type})}function Fe(e){return e&&e.__local_forage_encoded_blob}function ft(e){var n=this,t=n._initReady().then(function(){var o=M[n._dbInfo.name];if(o&&o.dbReady)return o.dbReady});return S(t,e,e),t}function ut(e){H(e);for(var n=M[e.name],t=n.forages,o=0;o<t.length;o++){var a=t[o];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return e.db=null,X(e).then(function(r){return e.db=r,ce(e)?ne(e):r}).then(function(r){e.db=n.db=r;for(var c=0;c<t.length;c++)t[c]._dbInfo.db=r}).catch(function(r){throw G(e,r),r})}function J(e,n,t,o){o===void 0&&(o=1);try{var a=e.db.transaction(e.storeName,n);t(null,a)}catch(r){if(o>0&&(!e.db||r.name==="InvalidStateError"||r.name==="NotFoundError"))return h.resolve().then(function(){if(!e.db||r.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),ne(e)}).then(function(){return ut(e).then(function(){J(e,n,t,o-1)})}).catch(t);t(r)}}function Ne(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function dt(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=e[o];var a=M[t.name];a||(a=Ne(),M[t.name]=a),a.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=ft);var r=[];function c(){return h.resolve()}for(var d=0;d<a.forages.length;d++){var p=a.forages[d];p!==n&&r.push(p._initReady().catch(c))}var m=a.forages.slice(0);return h.all(r).then(function(){return t.db=a.db,X(t)}).then(function(b){return t.db=b,ce(t,n._defaultConfig.version)?ne(t):b}).then(function(b){t.db=a.db=b,n._dbInfo=t;for(var _=0;_<m.length;_++){var P=m[_];P!==n&&(P._dbInfo.db=t.db,P._dbInfo.version=t.version)}})}function ht(e,n){var t=this;e=R(e);var o=new h(function(a,r){t.ready().then(function(){J(t._dbInfo,Q,function(c,d){if(c)return r(c);try{var p=d.objectStore(t._dbInfo.storeName),m=p.get(e);m.onsuccess=function(){var b=m.result;b===void 0&&(b=null),Fe(b)&&(b=ee(b)),a(b)},m.onerror=function(){r(m.error)}}catch(b){r(b)}})}).catch(r)});return T(o,n),o}function gt(e,n){var t=this,o=new h(function(a,r){t.ready().then(function(){J(t._dbInfo,Q,function(c,d){if(c)return r(c);try{var p=d.objectStore(t._dbInfo.storeName),m=p.openCursor(),b=1;m.onsuccess=function(){var _=m.result;if(_){var P=_.value;Fe(P)&&(P=ee(P));var k=e(P,_.key,b++);k!==void 0?a(k):_.continue()}else a()},m.onerror=function(){r(m.error)}}catch(_){r(_)}})}).catch(r)});return T(o,n),o}function pt(e,n,t){var o=this;e=R(e);var a=new h(function(r,c){var d;o.ready().then(function(){return d=o._dbInfo,Z.call(n)==="[object Blob]"?N(d.db).then(function(p){return p?n:me(n)}):n}).then(function(p){J(o._dbInfo,w,function(m,b){if(m)return c(m);try{var _=b.objectStore(o._dbInfo.storeName);p===null&&(p=void 0);var P=_.put(p,e);b.oncomplete=function(){p===void 0&&(p=null),r(p)},b.onabort=b.onerror=function(){var k=P.error?P.error:P.transaction.error;c(k)}}catch(k){c(k)}})}).catch(c)});return T(a,t),a}function mt(e,n){var t=this;e=R(e);var o=new h(function(a,r){t.ready().then(function(){J(t._dbInfo,w,function(c,d){if(c)return r(c);try{var p=d.objectStore(t._dbInfo.storeName),m=p.delete(e);d.oncomplete=function(){a()},d.onerror=function(){r(m.error)},d.onabort=function(){var b=m.error?m.error:m.transaction.error;r(b)}}catch(b){r(b)}})}).catch(r)});return T(o,n),o}function vt(e){var n=this,t=new h(function(o,a){n.ready().then(function(){J(n._dbInfo,w,function(r,c){if(r)return a(r);try{var d=c.objectStore(n._dbInfo.storeName),p=d.clear();c.oncomplete=function(){o()},c.onabort=c.onerror=function(){var m=p.error?p.error:p.transaction.error;a(m)}}catch(m){a(m)}})}).catch(a)});return T(t,e),t}function bt(e){var n=this,t=new h(function(o,a){n.ready().then(function(){J(n._dbInfo,Q,function(r,c){if(r)return a(r);try{var d=c.objectStore(n._dbInfo.storeName),p=d.count();p.onsuccess=function(){o(p.result)},p.onerror=function(){a(p.error)}}catch(m){a(m)}})}).catch(a)});return T(t,e),t}function yt(e,n){var t=this,o=new h(function(a,r){if(e<0){a(null);return}t.ready().then(function(){J(t._dbInfo,Q,function(c,d){if(c)return r(c);try{var p=d.objectStore(t._dbInfo.storeName),m=!1,b=p.openKeyCursor();b.onsuccess=function(){var _=b.result;if(!_){a(null);return}e===0||m?a(_.key):(m=!0,_.advance(e))},b.onerror=function(){r(b.error)}}catch(_){r(_)}})}).catch(r)});return T(o,n),o}function Tt(e){var n=this,t=new h(function(o,a){n.ready().then(function(){J(n._dbInfo,Q,function(r,c){if(r)return a(r);try{var d=c.objectStore(n._dbInfo.storeName),p=d.openKeyCursor(),m=[];p.onsuccess=function(){var b=p.result;if(!b){o(m);return}m.push(b.key),b.continue()},p.onerror=function(){a(p.error)}}catch(b){a(b)}})}).catch(a)});return T(t,e),t}function wt(e,n){n=D.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;if(!e.name)a=h.reject("Invalid arguments");else{var r=e.name===t.name&&o._dbInfo.db,c=r?h.resolve(o._dbInfo.db):X(e).then(function(d){var p=M[e.name],m=p.forages;p.db=d;for(var b=0;b<m.length;b++)m[b]._dbInfo.db=d;return d});e.storeName?a=c.then(function(d){if(d.objectStoreNames.contains(e.storeName)){var p=d.version+1;H(e);var m=M[e.name],b=m.forages;d.close();for(var _=0;_<b.length;_++){var P=b[_];P._dbInfo.db=null,P._dbInfo.version=p}var k=new h(function(B,W){var O=g.open(e.name,p);O.onerror=function(K){var oe=O.result;oe.close(),W(K)},O.onupgradeneeded=function(){var K=O.result;K.deleteObjectStore(e.storeName)},O.onsuccess=function(){var K=O.result;K.close(),B(K)}});return k.then(function(B){m.db=B;for(var W=0;W<b.length;W++){var O=b[W];O._dbInfo.db=B,$(O._dbInfo)}}).catch(function(B){throw(G(e,B)||h.resolve()).catch(function(){}),B})}}):a=c.then(function(d){H(e);var p=M[e.name],m=p.forages;d.close();for(var b=0;b<m.length;b++){var _=m[b];_._dbInfo.db=null}var P=new h(function(k,B){var W=g.deleteDatabase(e.name);W.onerror=function(){var O=W.result;O&&O.close(),B(W.error)},W.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},W.onsuccess=function(){var O=W.result;O&&O.close(),k(O)}});return P.then(function(k){p.db=k;for(var B=0;B<m.length;B++){var W=m[B];$(W._dbInfo)}}).catch(function(k){throw(G(e,k)||h.resolve()).catch(function(){}),k})})}return T(a,n),a}var Ct={_driver:"asyncStorage",_initStorage:dt,_support:x(),iterate:gt,getItem:ht,setItem:pt,removeItem:mt,clear:vt,length:bt,key:yt,keys:Tt,dropInstance:wt};function Et(){return typeof openDatabase=="function"}var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xt="~~local_forage_type~",Le=/^~~local_forage_type~([^~]+)~/,le="__lfsc__:",ve=le.length,be="arbf",ye="blob",ke="si08",Be="ui08",De="uic8",Oe="si16",Me="si32",He="ur16",We="ui32",Ue="fl32",$e="fl64",Ye=ve+be.length,ze=Object.prototype.toString;function Ge(e){var n=e.length*.75,t=e.length,o,a=0,r,c,d,p;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var m=new ArrayBuffer(n),b=new Uint8Array(m);for(o=0;o<t;o+=4)r=j.indexOf(e[o]),c=j.indexOf(e[o+1]),d=j.indexOf(e[o+2]),p=j.indexOf(e[o+3]),b[a++]=r<<2|c>>4,b[a++]=(c&15)<<4|d>>2,b[a++]=(d&3)<<6|p&63;return m}function Te(e){var n=new Uint8Array(e),t="",o;for(o=0;o<n.length;o+=3)t+=j[n[o]>>2],t+=j[(n[o]&3)<<4|n[o+1]>>4],t+=j[(n[o+1]&15)<<2|n[o+2]>>6],t+=j[n[o+2]&63];return n.length%3===2?t=t.substring(0,t.length-1)+"=":n.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function _t(e,n){var t="";if(e&&(t=ze.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&ze.call(e.buffer)==="[object ArrayBuffer]")){var o,a=le;e instanceof ArrayBuffer?(o=e,a+=be):(o=e.buffer,t==="[object Int8Array]"?a+=ke:t==="[object Uint8Array]"?a+=Be:t==="[object Uint8ClampedArray]"?a+=De:t==="[object Int16Array]"?a+=Oe:t==="[object Uint16Array]"?a+=He:t==="[object Int32Array]"?a+=Me:t==="[object Uint32Array]"?a+=We:t==="[object Float32Array]"?a+=Ue:t==="[object Float64Array]"?a+=$e:n(new Error("Failed to get type for BinaryArray"))),n(a+Te(o))}else if(t==="[object Blob]"){var r=new FileReader;r.onload=function(){var c=xt+e.type+"~"+Te(this.result);n(le+ye+c)},r.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(c){console.error("Couldn't convert value into a JSON string: ",e),n(null,c)}}function St(e){if(e.substring(0,ve)!==le)return JSON.parse(e);var n=e.substring(Ye),t=e.substring(ve,Ye),o;if(t===ye&&Le.test(n)){var a=n.match(Le);o=a[1],n=n.substring(a[0].length)}var r=Ge(n);switch(t){case be:return r;case ye:return I([r],{type:o});case ke:return new Int8Array(r);case Be:return new Uint8Array(r);case De:return new Uint8ClampedArray(r);case Oe:return new Int16Array(r);case He:return new Uint16Array(r);case Me:return new Int32Array(r);case We:return new Uint32Array(r);case Ue:return new Float32Array(r);case $e:return new Float64Array(r);default:throw new Error("Unkown type: "+t)}}var we={serialize:_t,deserialize:St,stringToBuffer:Ge,bufferToString:Te};function Ve(e,n,t,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,o)}function Rt(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=typeof e[o]!="string"?e[o].toString():e[o];var a=new h(function(r,c){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(d){return c(d)}t.db.transaction(function(d){Ve(d,t,function(){n._dbInfo=t,r()},function(p,m){c(m)})},c)});return t.serializer=we,a}function q(e,n,t,o,a,r){e.executeSql(t,o,a,function(c,d){d.code===d.SYNTAX_ERR?c.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(p,m){m.rows.length?r(p,d):Ve(p,n,function(){p.executeSql(t,o,a,r)},r)},r):r(c,d)},r)}function It(e,n){var t=this;e=R(e);var o=new h(function(a,r){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(d){q(d,c,"SELECT * FROM "+c.storeName+" WHERE key = ? LIMIT 1",[e],function(p,m){var b=m.rows.length?m.rows.item(0).value:null;b&&(b=c.serializer.deserialize(b)),a(b)},function(p,m){r(m)})})}).catch(r)});return T(o,n),o}function At(e,n){var t=this,o=new h(function(a,r){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(d){q(d,c,"SELECT * FROM "+c.storeName,[],function(p,m){for(var b=m.rows,_=b.length,P=0;P<_;P++){var k=b.item(P),B=k.value;if(B&&(B=c.serializer.deserialize(B)),B=e(B,k.key,P+1),B!==void 0){a(B);return}}a()},function(p,m){r(m)})})}).catch(r)});return T(o,n),o}function Ke(e,n,t,o){var a=this;e=R(e);var r=new h(function(c,d){a.ready().then(function(){n===void 0&&(n=null);var p=n,m=a._dbInfo;m.serializer.serialize(n,function(b,_){_?d(_):m.db.transaction(function(P){q(P,m,"INSERT OR REPLACE INTO "+m.storeName+" (key, value) VALUES (?, ?)",[e,b],function(){c(p)},function(k,B){d(B)})},function(P){if(P.code===P.QUOTA_ERR){if(o>0){c(Ke.apply(a,[e,p,t,o-1]));return}d(P)}})})}).catch(d)});return T(r,t),r}function Pt(e,n,t){return Ke.apply(this,[e,n,t,1])}function Ft(e,n){var t=this;e=R(e);var o=new h(function(a,r){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(d){q(d,c,"DELETE FROM "+c.storeName+" WHERE key = ?",[e],function(){a()},function(p,m){r(m)})})}).catch(r)});return T(o,n),o}function Nt(e){var n=this,t=new h(function(o,a){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(c){q(c,r,"DELETE FROM "+r.storeName,[],function(){o()},function(d,p){a(p)})})}).catch(a)});return T(t,e),t}function Lt(e){var n=this,t=new h(function(o,a){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(c){q(c,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(d,p){var m=p.rows.item(0).c;o(m)},function(d,p){a(p)})})}).catch(a)});return T(t,e),t}function kt(e,n){var t=this,o=new h(function(a,r){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(d){q(d,c,"SELECT key FROM "+c.storeName+" WHERE id = ? LIMIT 1",[e+1],function(p,m){var b=m.rows.length?m.rows.item(0).key:null;a(b)},function(p,m){r(m)})})}).catch(r)});return T(o,n),o}function Bt(e){var n=this,t=new h(function(o,a){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(c){q(c,r,"SELECT key FROM "+r.storeName,[],function(d,p){for(var m=[],b=0;b<p.rows.length;b++)m.push(p.rows.item(b).key);o(m)},function(d,p){a(p)})})}).catch(a)});return T(t,e),t}function Dt(e){return new h(function(n,t){e.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(a,r){for(var c=[],d=0;d<r.rows.length;d++)c.push(r.rows.item(d).name);n({db:e,storeNames:c})},function(a,r){t(r)})},function(o){t(o)})})}function Ot(e,n){n=D.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;return e.name?a=new h(function(r){var c;e.name===t.name?c=o._dbInfo.db:c=openDatabase(e.name,"","",0),e.storeName?r({db:c,storeNames:[e.storeName]}):r(Dt(c))}).then(function(r){return new h(function(c,d){r.db.transaction(function(p){function m(k){return new h(function(B,W){p.executeSql("DROP TABLE IF EXISTS "+k,[],function(){B()},function(O,K){W(K)})})}for(var b=[],_=0,P=r.storeNames.length;_<P;_++)b.push(m(r.storeNames[_]));h.all(b).then(function(){c()}).catch(function(k){d(k)})},function(p){d(p)})})}):a=h.reject("Invalid arguments"),T(a,n),a}var Mt={_driver:"webSQLStorage",_initStorage:Rt,_support:Et(),iterate:At,getItem:It,setItem:Pt,removeItem:Ft,clear:Nt,length:Lt,key:kt,keys:Bt,dropInstance:Ot};function Ht(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Qe(e,n){var t=e.name+"/";return e.storeName!==n.storeName&&(t+=e.storeName+"/"),t}function Wt(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(n){return!0}}function Ut(){return!Wt()||localStorage.length>0}function $t(e){var n=this,t={};if(e)for(var o in e)t[o]=e[o];return t.keyPrefix=Qe(e,n._defaultConfig),Ut()?(n._dbInfo=t,t.serializer=we,h.resolve()):h.reject()}function Yt(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo.keyPrefix,a=localStorage.length-1;a>=0;a--){var r=localStorage.key(a);r.indexOf(o)===0&&localStorage.removeItem(r)}});return T(t,e),t}function zt(e,n){var t=this;e=R(e);var o=t.ready().then(function(){var a=t._dbInfo,r=localStorage.getItem(a.keyPrefix+e);return r&&(r=a.serializer.deserialize(r)),r});return T(o,n),o}function Gt(e,n){var t=this,o=t.ready().then(function(){for(var a=t._dbInfo,r=a.keyPrefix,c=r.length,d=localStorage.length,p=1,m=0;m<d;m++){var b=localStorage.key(m);if(b.indexOf(r)===0){var _=localStorage.getItem(b);if(_&&(_=a.serializer.deserialize(_)),_=e(_,b.substring(c),p++),_!==void 0)return _}}});return T(o,n),o}function Vt(e,n){var t=this,o=t.ready().then(function(){var a=t._dbInfo,r;try{r=localStorage.key(e)}catch(c){r=null}return r&&(r=r.substring(a.keyPrefix.length)),r});return T(o,n),o}function Kt(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo,a=localStorage.length,r=[],c=0;c<a;c++){var d=localStorage.key(c);d.indexOf(o.keyPrefix)===0&&r.push(d.substring(o.keyPrefix.length))}return r});return T(t,e),t}function Qt(e){var n=this,t=n.keys().then(function(o){return o.length});return T(t,e),t}function Xt(e,n){var t=this;e=R(e);var o=t.ready().then(function(){var a=t._dbInfo;localStorage.removeItem(a.keyPrefix+e)});return T(o,n),o}function Jt(e,n,t){var o=this;e=R(e);var a=o.ready().then(function(){n===void 0&&(n=null);var r=n;return new h(function(c,d){var p=o._dbInfo;p.serializer.serialize(n,function(m,b){if(b)d(b);else try{localStorage.setItem(p.keyPrefix+e,m),c(r)}catch(_){(_.name==="QuotaExceededError"||_.name==="NS_ERROR_DOM_QUOTA_REACHED")&&d(_),d(_)}})})});return T(a,t),a}function jt(e,n){if(n=D.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var o=this,a;return e.name?a=new h(function(r){e.storeName?r(Qe(e,o._defaultConfig)):r(e.name+"/")}).then(function(r){for(var c=localStorage.length-1;c>=0;c--){var d=localStorage.key(c);d.indexOf(r)===0&&localStorage.removeItem(d)}}):a=h.reject("Invalid arguments"),T(a,n),a}var qt={_driver:"localStorageWrapper",_initStorage:$t,_support:Ht(),iterate:Gt,getItem:zt,setItem:Jt,removeItem:Xt,clear:Yt,length:Qt,key:Vt,keys:Kt,dropInstance:jt},Zt=function(n,t){return n===t||typeof n=="number"&&typeof t=="number"&&isNaN(n)&&isNaN(t)},en=function(n,t){for(var o=n.length,a=0;a<o;){if(Zt(n[a],t))return!0;a++}return!1},Xe=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},re={},Je={},te={INDEXEDDB:Ct,WEBSQL:Mt,LOCALSTORAGE:qt},tn=[te.INDEXEDDB._driver,te.WEBSQL._driver,te.LOCALSTORAGE._driver],fe=["dropInstance"],Ce=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(fe),nn={description:"",driver:tn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function rn(e,n){e[n]=function(){var t=arguments;return e.ready().then(function(){return e[n].apply(e,t)})}}function Ee(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var t in n)n.hasOwnProperty(t)&&(Xe(n[t])?arguments[0][t]=n[t].slice():arguments[0][t]=n[t])}return arguments[0]}var on=function(){function e(n){E(this,e);for(var t in te)if(te.hasOwnProperty(t)){var o=te[t],a=o._driver;this[t]=a,re[a]||this.defineDriver(o)}this._defaultConfig=Ee({},nn),this._config=Ee({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if((typeof t=="undefined"?"undefined":y(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var o in t){if(o==="storeName"&&(t[o]=t[o].replace(/\W/g,"_")),o==="version"&&typeof t[o]!="number")return new Error("Database version must be a number.");this._config[o]=t[o]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},e.prototype.defineDriver=function(t,o,a){var r=new h(function(c,d){try{var p=t._driver,m=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){d(m);return}for(var b=Ce.concat("_initStorage"),_=0,P=b.length;_<P;_++){var k=b[_],B=!en(fe,k);if((B||t[k])&&typeof t[k]!="function"){d(m);return}}var W=function(){for(var oe=function(cn){return function(){var ln=new Error("Method "+cn+" is not implemented by the current driver"),je=h.reject(ln);return T(je,arguments[arguments.length-1]),je}},xe=0,sn=fe.length;xe<sn;xe++){var _e=fe[xe];t[_e]||(t[_e]=oe(_e))}};W();var O=function(oe){re[p]&&console.info("Redefining LocalForage driver: "+p),re[p]=t,Je[p]=oe,c()};"_support"in t?t._support&&typeof t._support=="function"?t._support().then(O,d):O(!!t._support):O(!0)}catch(K){d(K)}});return S(r,o,a),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,o,a){var r=re[t]?h.resolve(re[t]):h.reject(new Error("Driver not found."));return S(r,o,a),r},e.prototype.getSerializer=function(t){var o=h.resolve(we);return S(o,t),o},e.prototype.ready=function(t){var o=this,a=o._driverSet.then(function(){return o._ready===null&&(o._ready=o._initDriver()),o._ready});return S(a,t,t),a},e.prototype.setDriver=function(t,o,a){var r=this;Xe(t)||(t=[t]);var c=this._getSupportedDrivers(t);function d(){r._config.driver=r.driver()}function p(_){return r._extend(_),d(),r._ready=r._initStorage(r._config),r._ready}function m(_){return function(){var P=0;function k(){for(;P<_.length;){var B=_[P];return P++,r._dbInfo=null,r._ready=null,r.getDriver(B).then(p).catch(k)}d();var W=new Error("No available storage method found.");return r._driverSet=h.reject(W),r._driverSet}return k()}}var b=this._driverSet!==null?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=b.then(function(){var _=c[0];return r._dbInfo=null,r._ready=null,r.getDriver(_).then(function(P){r._driver=P._driver,d(),r._wrapLibraryMethodsWithReady(),r._initDriver=m(c)})}).catch(function(){d();var _=new Error("No available storage method found.");return r._driverSet=h.reject(_),r._driverSet}),S(this._driverSet,o,a),this._driverSet},e.prototype.supports=function(t){return!!Je[t]},e.prototype._extend=function(t){Ee(this,t)},e.prototype._getSupportedDrivers=function(t){for(var o=[],a=0,r=t.length;a<r;a++){var c=t[a];this.supports(c)&&o.push(c)}return o},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,o=Ce.length;t<o;t++)rn(this,Ce[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),an=new on;u.exports=an},{3:3}]},{},[4])(4)})});var xn={};mn(xn,{default:()=>pe});module.exports=vn(xn);var ct=require("obsidian");var z=require("obsidian");var Y=Ze(Re()),de=require("obsidian");var ae=/\^\[[^^`\n]+\]/g,ie=/^[^\S\r\n]*(#{1,6}) +(.*)/m;async function nt(f,i){console.log("Tab Panels: Loading cache from Database");let s="Tab Panels: Finished loading cache ins";console.time(s);try{await Y.iterate((l,u)=>{let C=f.getCache(u);if(!C){i.vault.getFileByPath(u)?console.error("Tab Panels: Cannot get cacheMetadata from file. Path: ",u):(console.warn("Tab Panels: Cannot find file. Path: ",u,`
Removing cache from db`),Y.removeItem(u).catch(E=>console.error("Tab Panels: Error deleting cache from db. File path: ",u,`
ERROR: `,E)));return}ot(C),at(C,l),it(C,f,u);let y=i.vault.getFileByPath(u);y?(f.trigger("changed",y),f.trigger("resolve",y)):console.error(`Tab Panels: Cannot find file.
 Path: `,u)})}catch(l){console.error(`Tab Panels: Error loading cache from db to cachedMetadata. 
ERROR: `,l);return}console.timeEnd(s)}async function Ie(f,i){let s;try{s=await Y.getItem(i),s&&(await Y.setItem(f.path,s),await Y.removeItem(i))}catch(l){console.error("Tab Panels: Error updating from db. File path: ",f.path,`
ERROR: `,l);return}}async function Ae(f){try{await Y.removeItem(f.path)}catch(i){console.error("Tab Panels: Error deleting cache from db. File path: ",f.path,`
ERROR: `,i);return}}async function rt(f){new de.Notice("Tab Panels: Rebuilding cache...",3e3);let i="Tab Panels: Build time";console.time(i);try{let s=f.app;Y.clear();let l=f.app.vault.getMarkdownFiles();for(let u of l){let C=await f.app.vault.cachedRead(u),y=f.app.metadataCache.getFileCache(u);if(!y){console.error("Tab Panels: Error getting cache for file: "+u.path);continue}Pe(f,u,C,y),s.metadataCache.trigger("resolve",s.vault.getFileByPath(u.path))}}catch(s){console.error(`Tab Panels: Error rebuilding vault cache.
ERROR: `,s),new de.Notice("Tab Panels: Error rebuilding vault cache. Error:"+s),console.timeEnd(i);return}console.timeEnd(i),new de.Notice("Tab Panels: Finished building cache",3e3)}async function Pe(f,i,s,l){let u=f.app.metadataCache,C={};ot(l);let y=new RegExp(`^ {0,3}(\`{3,}|~{3,}) *${f.settings.codeblockKeyword}[ \\w]*
([\\s\\S]*?)\\1`,"gm"),E=[...s.matchAll(y)],v=0,g=1,x=!1;for(let h of E){if(h.index===void 0){console.error(`Tab panels: Error when parsing markdown, splitting markdown blocks. Match index === undefined
Match:`,h);return}let T=s.slice(v,h.index);v=h.index,g+=T.split(`
`).length-1;let S={line:g,col:0,offset:h.index+h[1].length+5},R=h[2];bn(R,S,C)&&(x=!0)}x&&(at(l,C),it(l,u,i.path));let I=Cn(s,l,C,E);I&&(x=I);try{x?await Y.setItem(i.path,C):await Y.removeItem(i.path)}catch(h){console.error("Tab Panels: Error updating cache in db. File path: ",i.path,`
ERROR: `,h);return}}function bn(f,i,s){let l=f.split(`
`),u=0;return l.forEach((C,y)=>{let E=i.line+y,v=i.offset+u;yn(C,E,v,s),Tn(C,E,v,s),wn(C,E,v,s),u+=C.length+1}),En(f,i,s),s&&Object.keys(s).length>0}function yn(f,i,s,l){let u=/!?\[\[([^|\]]+)(?:\|([^\]]+))?\]\]/g,C=[...f.matchAll(u)];if(C.length>0){let y=[],E=[];C.forEach(v=>{var h;let g=v.index?v.index:0,x={line:i,col:g,offset:s+g},I={link:v[1],original:v[0],displayText:(h=v[2])!=null?h:v[1],position:{start:x,end:{line:x.line,col:x.col+v[0].length,offset:x.offset+v[0].length}}};v[0][0]!=="!"?y.push(I):E.push(I)}),l.links?l.links.push(...y):l.links=y,l.embeds?l.embeds.push(...E):l.embeds=E}}function Tn(f,i,s,l){let u=f.match(ie);if(u){let C=u.index?u.index:0,y={line:i,col:C,offset:s+C},E={heading:u[2].trimEnd(),level:u[1].length,position:{start:y,end:{line:y.line,col:y.col+u[0].length,offset:y.offset+u[0].length}}};l.headings?l.headings.push(E):l.headings=[E]}}function wn(f,i,s,l){let u=/(?<=^|\s)#[^\s~!@#$%^&*()+={}|:;"'<>?`[\]\\,.]+/g,C=[...f.matchAll(u)];if(C.length>0){let y=[];C.forEach(E=>{let v=E.index?E.index:0,g={line:i,col:v,offset:s+v},x={tag:E[0],position:{start:g,end:{line:g.line,col:g.col+E[0].length,offset:g.offset+E[0].length}}};y.push(x)}),l.tags?l.tags.push(...y):l.tags=y}}function Cn(f,i,s,l){if(l.length===0)return!1;let u=-1,C=Number.MAX_SAFE_INTEGER,y=Number.MAX_SAFE_INTEGER,E=g=>{u=g;let x=l[g];x.index?C=x.index:(C=0,console.error("Rebuilding inline footnotes, regex match.index === ",x.index)),y=C+x.length},v=[...f.matchAll(ae)];return v.length===0?!1:(i.footnotes||(i.footnotes=[]),s.footnotes||(s.footnotes=[]),v.forEach((g,x)=>{var h,T,S;let I=(h=g.index)!=null?h:0;for(;I>C;){if(u>=l.length-1){console.error(`Rebuilding footnote cache, While loop went over number of tab matches.
`,"Index: ",u," | Matches: ",l.length);break}E(u++)}if(I<y){let R={line:0,col:I,offset:I+2},D={id:`[inline${x}`,position:{start:R,end:{line:R.line,col:R.col+g[0].length,offset:R.offset+g[0].length-3}}};(T=s.footnotes)==null||T.push(D);let L={...D,isFromTabPanels:!0};(S=i.footnotes)==null||S.push(L)}}),!0)}function En(f,i,s){let l=0,u=i.line,C=/^\[\^([^^`\n]+)]:([^^`\n]+(?:\n[^^`\n]+)?)$/gm,y=[...f.matchAll(C)];if(y.length>0){let E=[],v=[];y.forEach(g=>{if(!g.index){console.error("Tab panels: Parsing sections for footnote definition. Unknown match index value: ",g.index,`
Match:`,g);return}let x=f.slice(l,g.index);l=g.index,u+=x.split(`
`).length-1;let I=g.index?g.index:0,h={line:u,col:I,offset:g.index+i.offset},T={start:h,end:{line:h.line,col:h.col+g[0].length,offset:h.offset+g[0].length}},S={id:g[1],position:T};E.push(S);let R={footnoteId:g[1],type:"footnoteDefinition",position:T};v.push(R)}),s.footnotes?s.footnotes.push(...E):s.footnotes=E,s.sections?s.sections.push(...v):s.sections=v}}function ot(f){f.links&&(f.links=f.links.filter(i=>!i.isFromTabPanels)),f.embeds&&(f.embeds=f.embeds.filter(i=>!i.isFromTabPanels)),f.headings&&(f.headings=f.headings.filter(i=>!i.isFromTabPanels)),f.tags&&(f.tags=f.tags.filter(i=>!i.isFromTabPanels)),f.footnotes&&(f.footnotes=f.footnotes.filter(i=>!i.isFromTabPanels)),f.sections&&(f.sections=f.sections.filter(i=>!i.isFromTabPanels))}function at(f,i){var s,l,u,C,y,E;if(i.links&&i.links.length>0){let v=i.links.map(g=>({...g,isFromTabPanels:!0}));f.links?(s=f.links)==null||s.push(...v):f.links=v}if(i.embeds&&i.embeds.length>0){let v=i.embeds.map(g=>({...g,isFromTabPanels:!0}));f.embeds?(l=f.embeds)==null||l.push(...v):f.embeds=v}if(i.headings&&i.headings.length>0){let v=i.headings.map(g=>({...g,isFromTabPanels:!0}));f.headings?(u=f.headings)==null||u.push(...v):f.headings=v,f.headings.sort(tt)}if(i.tags&&i.tags.length>0){let v=i.tags.map(g=>({...g,isFromTabPanels:!0}));f.tags?(C=f.tags)==null||C.push(...v):f.tags=v}if(i.footnotes&&i.footnotes.length>0){let v=i.footnotes.map(x=>({...x,isFromTabPanels:!0}));f.footnotes?(y=f.footnotes)==null||y.push(...v):f.footnotes=v,f.footnotes.sort(tt);let g=0;f.footnotes.forEach((x,I)=>{x.id.startsWith("[inline")&&(x.id=`[inline${g++}`)})}if(i.sections&&i.sections.length>0){let v=i.sections.map(g=>({...g,isFromTabPanels:!0}));f.sections?(E=f.sections)==null||E.push(...v):f.sections=v}}function it(f,i,s){let l=f.links,u=i.resolvedLinks[s],C=i.unresolvedLinks[s];l&&l.forEach(y=>{if(!y.isFromTabPanels)return;let E=y.link,v=E.indexOf("#");v>0&&(E=E.substring(0,v));let g=i.getFirstLinkpathDest(E,""),x="",I;g===null?(I=C,x=E):(I=u,x=g.path),I[x]===void 0&&(I[x]=0),I[x]++})}function tt(f,i){let s=f.position.start.offset,l=i.position.start.offset;return s<l?-1:s>l?1:(console.warn("Tab Panels: Cache item with same offset",`
Cache A:`,f,"Cache B:",i),0)}var st={codeblockKeyword:"tabs",tabMarkerSyntax:"---",showNoTabWarning:!0,highlightSelectedTabName:!0,enableCaching:!1},he=class extends z.PluginSettingTab{constructor(s,l){super(s,l);this.plugin=l}display(){let{containerEl:s}=this,l=this.plugin.settings;s.empty(),new z.Setting(s).setName("Codeblock keyword").addText(S=>S.setValue(l.codeblockKeyword).setPlaceholder("tabs").onChange(async R=>{l.codeblockKeyword=R.trim(),await this.plugin.saveSettings()}));let u=new DocumentFragment,C=()=>`${l.tabMarkerSyntax||"---"} New Tab`;u.detach(),u.appendText("Set the marker format that defines a new tab in your markdown"),u.appendChild(createEl("br")),u.appendText("Example: ");let y=createEl("code",{text:C()});u.appendChild(y);let E=createDiv({text:"No syntax detected. Default to ---",cls:"mod-warning"});u.appendChild(E);let v=()=>E.style.display=l.tabMarkerSyntax?"none":"block";v(),new z.Setting(s).setName("Tab marker syntax").setDesc(u).addText(S=>S.setValue(l.tabMarkerSyntax).setPlaceholder("---, ===, tabs:").onChange(async R=>{l.tabMarkerSyntax=R.trim(),await this.plugin.saveSettings(),y.textContent=C(),v()})),new z.Setting(s).setName("Show no tab warning").addToggle(S=>S.setValue(l.showNoTabWarning).onChange(async R=>{l.showNoTabWarning=R,await this.plugin.saveSettings()})),new z.Setting(s).setHeading().setName("Styling"),new z.Setting(s).setName("Highlight selected tab name").addToggle(S=>S.setValue(l.highlightSelectedTabName).onChange(async R=>{l.highlightSelectedTabName=R,await this.plugin.saveSettings()})),new z.Setting(s).setHeading().setName("Experimental");let g=new DocumentFragment;g.appendText(`Add additional information to Obsidian's cache.
`),g.appendChild(createEl("a",{text:" Learn more",href:"https://github.com/GnoxNahte/obsidian-tab-panels/tree/main#cache-experimental"})),g.appendChild(createEl("br")),g.appendText("This allows backlinks, outgoing links, headings, tags showing on the sidebar. Also supports renaming files, tags."),g.appendChild(createEl("br")),g.appendText("It should also allow other plugins that uses the cache like Dataview");let x=createEl("div",{text:"Since this is this is still experimental. ",cls:"mod-warning",parent:g}),I=createEl("ul",{parent:x});if(I.appendChild(createEl("li",{text:"Some things might not work as expected. Report issues "})).appendChild(createEl("a",{text:"here",href:"https://github.com/GnoxNahte/obsidian-tab-panels/issues/new/choose"})),I.appendChild(createEl("li",{text:"However, even if things go wrong, it shouldn't affect your files."})),I.appendChild(createEl("li",{text:"You can always revert it by disabling caching then reloading Obsidian"})),new z.Setting(s).setName("Enable caching").setDesc(g).addToggle(S=>S.setValue(l.enableCaching).onChange(async R=>{l.enableCaching=R,await this.plugin.saveSettings(),this.display(),l.enableCaching&&(await this.plugin.loadCacheFromDb(),new z.Notice("Tab Panels: Loading cache...",3e3))})),l.enableCaching){let S=new DocumentFragment;S.appendText("This is rebuilds the cache if you encounter syncing issues. "),S.appendChild(createEl("div",{text:"It might take sometime depending on the size of your vault",cls:"mod-warning"})),new z.Setting(s).setName("Rebuild cache").setDesc(S).addButton(R=>R.setButtonText("Rebuild").setClass("mod-warning").onClick(async D=>{await rt(this.plugin)}))}let T=new DocumentFragment;T.appendText("Reload the app to apply changes"),T.appendChild(createEl("br")),T.appendChild(createEl("br")),T.appendText("Found bugs or want a feature? "),T.appendChild(createEl("a",{text:"Create a GitHub issue!",href:"https://github.com/GnoxNahte/obsidian-tab-panels/issues/new/choose"})),new z.Setting(s).setDesc(T)}};var se=require("obsidian");var ge=class{constructor(i){this.plugin=i,this.tabsRegex=new RegExp(`^[^\\S\r
]*${this.plugin.settings.tabMarkerSyntax}[^\\S\r
]*(.*)`,"gm")}async create(i,s,l){var h;let u=/^ *~{3,}|`{3,}/gm;s.classList.add("tab-panel-container"),this.plugin.settings.highlightSelectedTabName&&s.classList.add("highlight-selected-tab-name");let C=createEl("div",{cls:"tab-scroll-container",parent:s}),y=createEl("ul",{cls:"tab-container",parent:C}),E=createDiv({cls:"content-container",parent:s}),v=this.tabsRegex,g=Array.from(i.matchAll(v));if(g.length>0){let T=i.substring(0,g[0].index),S=Array.from(T.matchAll(u));if(!this.checkIfCodeblockClosed(S)){let R=S[0],D=i.indexOf(R[0],((h=R.index)!=null?h:0)+1);if(D!==-1){let L=i.slice(0,D),U=Array.from(L.matchAll(v)).length;g.splice(0,U)}else g.length=0}}if(g.length===0){C.classList.add("hide-container");let T=this.renderMarkdown(E,"",i,l.sourcePath);if(T.classList.add("selected"),this.plugin.settings.showNoTabWarning){let S=`> [!WARNING] No tabs created
> To create tabs, use '${this.plugin.settings.tabMarkerSyntax} Tab Name'. 
>For more info: [GitHub README](https://github.com/GnoxNahte/obsidian-tab-panels)
>To hide this popup: Settings > Hide no tab warning`;se.MarkdownRenderer.render(this.plugin.app,S,T,l.sourcePath,this.plugin)}await this.modifyRenderedContent(i,s,l);return}let x=0,I=-1;for(let T=0;T<g.length;T++){++I;let S=g[T][1],R=[],D=S.match(/\(default\)\s*/i);D&&D.index&&(x=I,S=S.substring(D.index,D.index+D[0].length));let L=S.match(/\(css-?class: *([ \w-]*)\)/i);L&&L.index&&(R=L[1].split(" ").filter(F=>F),S=S.substring(0,L.index));let U=createEl("li",{cls:"tab",parent:y});R&&U.addClasses(R);let M=I;U.addEventListener("click",()=>this.switchTab(M,y,E)),se.MarkdownRenderer.render(this.plugin.app,S,U,l.sourcePath,this.plugin);let Z=F=>{var H;let A=T<g.length-1?g[T+1].index:i.length,N=i.substring((H=g[T].index)!=null?H:0,A);if(F){let $=N.indexOf(`
`);return $!==-1?N.substring($):""}else return N},Q=Z(!0);do{let F=Array.from(Q.matchAll(u));if(this.checkIfCodeblockClosed(F))break;if(++T,T>=g.length)break;Q+=Z(!1)}while(T+1<g.length);let w=this.renderMarkdown(E,S,Q,l.sourcePath);R&&w.addClasses(R)}await this.modifyRenderedContent(i,s,l),this.switchTab(x,y,E,!0)}renderMarkdown(i,s,l,u){let C=createDiv({parent:i});if(s){let E=createDiv({parent:C,cls:"pdf-tab-header tab selected"});se.MarkdownRenderer.render(this.plugin.app,s,E,u,this.plugin)}let y=createDiv({parent:C,cls:"rendered-content"});return se.MarkdownRenderer.render(this.plugin.app,l,y,u,this.plugin),C}checkIfCodeblockClosed(i){if(i===null||i.length===0)return!0;let s=[];for(let l of i){let u=s.indexOf(l[0]);u!==-1?s.splice(u):s.push(l[0])}return s.length===0}switchTab(i,s,l,u=!1){let C="selected",y=s.children;for(let I=0;I<y.length;I++)y[I].classList.remove(C);let E=l.children;for(let I=0;I<E.length;I++)E[I].classList.remove(C);let v=y[i];if(v.classList.add(C),E[i].classList.add(C),!u||i===0)return;if(s.parentElement===null){console.error("Tab Panels: Cannot find scroll element");return}function x(){setTimeout(()=>{if(s.parentElement===null)return;let I=v.offsetLeft;s.parentElement.scrollLeft=I-35,s.parentElement.scrollLeft===0&&x()},100)}x()}async modifyRenderedContent(i,s,l){if(!this.plugin.settings.enableCaching)return;let u=await this.getMarkdownBeforeCodeBlock(s,l);u&&(this.modifyInlineFootnotesPos(i,u,s),this.updateOutline(i,u,s))}async getMarkdownBeforeCodeBlock(i,s){let l=s.getSectionInfo(i);if(!l)return console.log("Tab Panels: Section info returning null"),null;let u=this.plugin.app.vault.getFileByPath(s.sourcePath);if(!u)return console.error("Tab Panels: Can't find file: ",s.sourcePath),null;let C=await this.plugin.app.vault.cachedRead(u),y=[...C.matchAll(/\n/g)];return l.lineStart>y.length?(console.error(`Tab Panels: Error, section info line start larger than number of lines in markdown. 
Line end:`,l.lineStart,`
Number of lines from markdown: `,y.length),null):C.substring(0,y[l.lineStart].index)}modifyInlineFootnotesPos(i,s,l){let u=[...s.matchAll(ae)].length,C=l.querySelector(".content-container");if(!C){console.error("Tab Panels: Can't find container");return}let y=C.querySelectorAll("a.footnote-link[data-footref]");[...i.matchAll(ae)].forEach((v,g)=>{let x=y[g];x.dataset.footref=`[inline${g+u}`})}async updateOutline(i,s,l){let u=ie.flags;u.contains("g")||(u+="g");let C=RegExp(ie,u),y=[...s.matchAll(C)].length,E=[...i.matchAll(C)].length;await new Promise(R=>setTimeout(R,200));let g=this.plugin.app.workspace.getLeavesOfType("outline")[0].view.containerEl,x=Array.from(g.querySelectorAll("div.tree-item-self.is-clickable")),I=y,h=y+E,T=x.slice(I,h);if(!l.closest(".markdown-reading-view"))return;let S=Array.from(l.querySelectorAll(".markdown-reading-view :is(h1,h2,h3,h4,h5,h6)"));if(T.length!==S.length){console.error("Outline heading length and headings in tab panels rendered markdown doesn't match up",`
Outline Headings:`,T.map(R=>R.textContent),`
Headings in plugin:`,S.map(R=>R.textContent));return}T.forEach((R,D)=>{R.addEventListener("click",L=>{L.preventDefault();let U=S[D];U.classList.add("is-flashing"),setTimeout(()=>{U.classList.remove("is-flashing")},3e3),U.scrollIntoView()})})}};var lt=Ze(Re()),pe=class extends ct.Plugin{constructor(){super(...arguments);this.onMetadataCacheChangedHandler=this.onMetadataCacheChanged.bind(this);this.loadCacheFromDbHandler=this.loadCacheFromDb.bind(this);this.debug_outputMetadataCacheHandler=this.debug_outputMetadataCache.bind(this)}async onload(){if(this.isCacheLoaded=!1,await this.loadSettings(),this.tabPanelBuilder=new ge(this),this.registerMarkdownCodeBlockProcessor(this.settings.codeblockKeyword,async(s,l,u)=>this.tabPanelBuilder.create(s,l,u)),this.settings.enableCaching){let s=this.app.appId||"shared";lt.config({name:`tab-panels/cache/${s}`}),this.app.workspace.onLayoutReady(this.loadCacheFromDbHandler),this.app.metadataCache.on("changed",this.onMetadataCacheChangedHandler),this.app.vault.on("rename",Ie),this.app.vault.on("delete",Ae)}this.addSettingTab(new he(this.app,this))}async loadSettings(){let s=Object.assign({},st,await this.loadData());this.settings=s,s.hideNoTabWarning&&(this.settings.showNoTabWarning=!s.hideNoTabWarning),await this.saveSettings()}async saveSettings(){await this.saveData(this.settings)}onunload(){this.app.metadataCache.off("changed",this.onMetadataCacheChangedHandler),this.app.vault.off("rename",Ie),this.app.vault.off("delete",Ae)}async loadCacheFromDb(){await nt(this.app.metadataCache,this.app),this.isCacheLoaded=!0}async onMetadataCacheChanged(s,l,u){this.isCacheLoaded&&await Pe(this,s,l,u)}debug_outputMetadataCache(s,l,u){console.log("File: ",s.path,`Cache:
`,this.app.metadataCache.getCache(s.path),`
Resolved links`,this.app.metadataCache.resolvedLinks,`
Unresolved `,this.app.metadataCache.unresolvedLinks)}};
/*! Bundled license information:

localforage/dist/localforage.js:
  (*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  *)
*/

/* nosourcemap */